<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å”æšã’ãƒ‘ãƒ‹ãƒƒã‚¯ï¼šæ»‘ã‚‰ã‹ç§»å‹•ç·¨</title>
    <style>
        body { 
            margin: 0; padding: 0; text-align: center; 
            background-color: #d2b48c;
            background-image: linear-gradient(45deg, #deb887 25%, transparent 25%, transparent 75%, #deb887 75%, #deb887), linear-gradient(45deg, #deb887 25%, transparent 25%, transparent 75%, #deb887 75%, #deb887);
            background-size: 60px 60px; background-position: 0 0, 30px 30px;
            overflow: hidden; font-family: sans-serif; touch-action: none;
        }
        #order-ui { width: 100%; height: 50px; background: rgba(0,0,0,0.8); color: white; display: flex; align-items: center; justify-content: center; position: fixed; top: 0; z-index: 100; }
        
        /* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ï¼ˆtransitionã‚’æ¶ˆã—ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§åˆ¶å¾¡ï¼‰ */
        #char { font-size: 60px; position: absolute; z-index: 10; width: 60px; height: 60px; line-height: 60px; pointer-events: none; }
        
        /* å”æšã’ */
        #karaage { font-size: 40px; position: absolute; display: none; width: 40px; height: 40px; }

        /* ä¸‹ã®æ“ä½œãƒ‘ãƒãƒ«ï¼ˆé€æ˜ã«ã—ã¦ç§»å‹•ã‚¨ãƒªã‚¢ã‚’åºƒã’ã‚‹ï¼‰ */
        #control-panel { width: 100%; height: 100px; background: rgba(139, 69, 19, 0.8); position: fixed; bottom: 0; display: flex; align-items: center; justify-content: center; z-index: 50; }
        #status { color: white; font-weight: bold; position: fixed; top: 60px; width: 100%; text-shadow: 2px 2px 2px black; z-index: 100; }
        #btn { width: 80px; height: 80px; background: #D2691E; color: white; border-radius: 50%; border: 3px solid #fff; font-size: 14px; font-weight: bold; z-index: 200; }
    </style>
</head>
<body>
    <div id="order-ui">ğŸƒâ€â™‚ï¸ è‡ªç”±ã«æ­©ãå›ã£ã¦é£Ÿã¹ã‚ï¼</div>
    <div id="status">æº€è…¹åº¦: 0%</div>
    <div id="karaage">ğŸ—</div>
    <div id="char">ğŸ‘¨â€ğŸ³</div>
    
    <div id="control-panel">
        <button id="btn">é£Ÿã¹ã‚‹ï¼</button>
    </div>

    <script>
        let fullness = 0;
        let pX = window.innerWidth / 2; // ã‚­ãƒ£ãƒ©ä½ç½®X
        let pY = window.innerHeight / 2; // ã‚­ãƒ£ãƒ©ä½ç½®Y
        let targetX = pX;
        let targetY = pY;
        let kX = 0, kY = 0; // å”æšã’ä½ç½®
        let isTouching = false;

        const char = document.getElementById('char');
        const karaage = document.getElementById('karaage');
        const status = document.getElementById('status');
        const btn = document.getElementById('btn');

        function spawnKaraage() {
            kX = Math.random() * (window.innerWidth - 60) + 30;
            kY = Math.random() * (window.innerHeight - 250) + 100;
            karaage.style.left = kX - 20 + "px";
            karaage.style.top = kY - 20 + "px";
            karaage.style.display = "block";
        }
        spawnKaraage();

        // ã‚¿ãƒƒãƒé–‹å§‹ãƒ»ç§»å‹•æ™‚ã®å‡¦ç†
        const handleTouch = (e) => {
            const touch = e.touches[0];
            // é£Ÿã¹ã‚‹ãƒœã‚¿ãƒ³ã®ä¸Šã¯ç§»å‹•ã‚’åå¿œã•ã›ãªã„
            if (e.target.id !== 'btn') {
                targetX = touch.clientX;
                targetY = touch.clientY;
                isTouching = true;
            }
        };

        window.addEventListener('touchstart', handleTouch);
        window.addEventListener('touchmove', handleTouch);
        window.addEventListener('touchend', () => isTouching = false);

        // ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—ï¼ˆ1ç§’é–“ã«60å›å®Ÿè¡Œã—ã¦æ»‘ã‚‰ã‹ã«å‹•ã‹ã™ï¼‰
        function gameLoop() {
            if (isTouching) {
                // ã‚­ãƒ£ãƒ©ã‚’ç›®æ¨™åœ°ç‚¹ã«è¿‘ã¥ã‘ã‚‹ï¼ˆ0.1ã®éƒ¨åˆ†ã‚’å¤‰ãˆã‚‹ã¨é€Ÿåº¦ãŒå¤‰ã‚ã‚‹ï¼‰
                pX += (targetX - pX) * 0.12;
                pY += (targetY - pY) * 0.12;
            }

            char.style.left = (pX - 30) + "px";
            char.style.top = (pY - 30) + "px";

            requestAnimationFrame(gameLoop);
        }
        gameLoop();

        // é£Ÿã¹ã‚‹ãƒœã‚¿ãƒ³
        btn.onclick = (e) => {
            e.stopPropagation(); // ç§»å‹•ã‚¤ãƒ™ãƒ³ãƒˆã‚’é‚ªé­”ã—ãªã„
            let dist = Math.hypot(pX - kX, pY - kY);
            if (dist < 60) {
                fullness += 20;
                status.innerText = `æº€è…¹åº¦: ${fullness}%`;
                char.innerText = "ğŸ˜‹";
                karaage.style.display = "none";<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>å”æšã’ãƒ‘ãƒ‹ãƒƒã‚¯ï¼šæœ¬æ ¼æ“ä½œç·¨</title>
    <style>
        body { 
            margin: 0; padding: 0; text-align: center; 
            background-color: #d2b48c;
            background-image: linear-gradient(45deg, #deb887 25%, transparent 25%, transparent 75%, #deb887 75%, #deb887), linear-gradient(45deg, #deb887 25%, transparent 25%, transparent 75%, #deb887 75%, #deb887);
            background-size: 60px 60px; background-position: 0 0, 30px 30px;
            overflow: hidden; font-family: sans-serif; touch-action: none;
        }
        #order-ui { width: 100%; height: 50px; background: rgba(0,0,0,0.8); color: white; display: flex; align-items: center; justify-content: center; position: fixed; top: 0; z-index: 100; }
        #status { color: white; font-weight: bold; position: fixed; top: 60px; width: 100%; text-shadow: 2px 2px 2px black; z-index: 100; }
        
        /* ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ã¨å”æšã’ */
        #char { font-size: 60px; position: absolute; z-index: 10; width: 60px; height: 60px; line-height: 60px; transform: translate(-50%, -50%); }
        #karaage { font-size: 40px; position: absolute; display: none; width: 40px; height: 40px; transform: translate(-50%, -50%); }

        /* å·¦ä¸‹ï¼šä»®æƒ³ã‚¹ãƒ†ã‚£ãƒƒã‚¯ã‚¨ãƒªã‚¢ */
        #joystick-area { position: fixed; bottom: 20px; left: 20px; width: 150px; height: 150px; background: rgba(255,255,255,0.2); border-radius: 50%; z-index: 200; touch-action: none; }
        #joystick-stick { position: absolute; top: 50%; left: 50%; width: 60px; height: 60px; background: rgba(255,255,255,0.5); border-radius: 50%; transform: translate(-50%, -50%); }

        /* å³ä¸‹ï¼šã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        #action-btn-area { position: fixed; bottom: 40px; right: 30px; z-index: 200; }
        #btn { width: 100px; height: 100px; background: #D2691E; color: white; border-radius: 50%; border: 4px solid #fff; font-size: 18px; font-weight: bold; box-shadow: 0 6px #5d4037; }
        #btn:active { transform: scale(0.9); box-shadow: 0 2px #5d4037; }
    </style>
</head>
<body>
    <div id="order-ui">ğŸ•¹ï¸ ã‚¹ãƒ†ã‚£ãƒƒã‚¯ã§ç§»å‹•ã›ã‚ˆï¼</div>
    <div id="status">æº€è…¹åº¦: 0%</div>
    <div id="karaage">ğŸ—</div>
    <div id="char">ğŸ‘¨â€ğŸ³</div>
    
    <div id="joystick-area"><div id="joystick-stick"></div></div>
    
    <div id="action-btn-area">
        <button id="btn">é£Ÿã¹ã‚‹ï¼</button>
    </div>

    <script>
        let fullness = 0;
        let pX = window.innerWidth / 2, pY = window.innerHeight / 2;
        let kX = 0, kY = 0;
        let joyX = 0, joyY = 0; // ã‚¹ãƒ†ã‚£ãƒƒã‚¯ã®å‚¾ã (-1 to 1)
        let isMoving = false;

        const char = document.getElementById('char');
        const karaage = document.getElementById('karaage');
        const status = document.getElementById('status');
        const stick = document.getElementById('joystick-stick');
        const joyArea = document.getElementById('joystick-area');

        function spawnKaraage() {
            kX = Math.random() * (window.innerWidth - 100) + 50;
            kY = Math.random() * (window.innerHeight - 300) + 100;
            karaage.style.left = kX + "px";
            karaage.style.top = kY + "px";
            karaage.style.display = "block";
        }
        spawnKaraage();

        // ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ“ä½œãƒ­ã‚¸ãƒƒã‚¯
        joyArea.addEventListener('touchstart', (e) => { isMoving = true; moveStick(e); });
        joyArea.addEventListener('touchmove', (e) => { moveStick(e); });
        joyArea.addEventListener('touchend', () => {
            isMoving = false;
            joyX = 0; joyY = 0;
            stick.style.left = "50%"; stick.style.top = "50%";
        });

        function moveStick(e) {
            const touch = e.touches[0];
            const rect = joyArea.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            let dx = touch.clientX - centerX;
            let dy = touch.clientY - centerY;
            const distance = Math.min(Math.hypot(dx, dy), 60);
            const angle = Math.atan2(dy, dx);
            
            joyX = (Math.cos(angle) * distance) / 60;
            joyY = (Math.sin(angle) * distance) / 60;
            
            stick.style.left = (50 + joyX * 40) + "%";
            stick.style.top = (50 + joyY * 40) + "%";
        }

        function gameLoop() {
            if (isMoving) {
                pX += joyX * 6; // 6 = ç§»å‹•ã‚¹ãƒ”ãƒ¼ãƒ‰
                pY += joyY * 6;
                // ç”»é¢ç«¯ã®åˆ¶é™
                pX = Math.max(30, Math.min(window.innerWidth - 30, pX));
                pY = Math.max(60, Math.min(window.innerHeight - 150, pY));
            }
            char.style.left = pX + "px";
            char.style.top = pY + "px";
            requestAnimationFrame(gameLoop);
        }
        gameLoop();

        document.getElementById('btn').onclick = () => {
            let dist = Math.hypot(pX - kX, pY - kY);
            if (dist < 70) {
                fullness += 20;
                status.innerText = `æº€è…¹åº¦: ${fullness}%`;
                char.innerText = "ğŸ˜‹";
                karaage.style.display = "none";
                setTimeout(() => { 
                    char.innerText = fullness >= 100 ? "ğŸˆµ" : "ğŸ‘¨â€ğŸ³"; 
                    if(fullness < 100) spawnKaraage();
                }, 300);
            }
        };
    </script>
</body>
</html>
                
                setTimeout(() => { 
                    char.innerText = fullness >= 100 ? "ğŸˆµ" : "ğŸ‘¨â€ğŸ³"; 
                    if(fullness < 100) spawnKaraage();
                }, 300);
            } else {
                char.innerText = "â“";
                setTimeout(() => { char.innerText = "ğŸ‘¨â€ğŸ³"; }, 300);
            }
        };
    </script>
</body>
</html>